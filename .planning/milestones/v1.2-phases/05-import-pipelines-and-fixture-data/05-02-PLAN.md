---
phase: 05-import-pipelines-and-fixture-data
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - backend/app/seed/fixtures/powders.json
  - backend/app/seed/fixtures/powder_aliases.json
  - backend/app/seed/fixtures/bullets.json
  - backend/app/seed/fixtures/cartridges.json
autonomous: true
requirements: [PWD-01, PWD-05, BUL-01, BUL-02, CRT-01, CRT-02]

must_haves:
  truths:
    - "Powder fixture contains 200+ records from multiple manufacturers with thermochemical parameters"
    - "Bullet fixture contains 100-200 records from Sierra, Hornady, Berger, Nosler, Lapua covering .308, 6.5CM, .223, .300WM calibers"
    - "Cartridge fixture contains 50+ records with SAAMI/CIP specs, bore/groove diameters, and parent cartridge lineage"
    - "Powder alias fixture maps ADI/Hodgdon equivalents and other known cross-market aliases"
    - "Bullet records include manufacturer, model_number, weight, diameter, BC G1/G7, bullet_type, and base_type per BUL-02"
    - "Bullets cover both match/precision and hunting lines per user decision (no varmint/plinking/FMJ)"
  artifacts:
    - path: "backend/app/seed/fixtures/powders.json"
      provides: "200+ powder records with thermochemical parameters"
      min_lines: 2000
    - path: "backend/app/seed/fixtures/powder_aliases.json"
      provides: "Alias group mappings linking equivalent powders across markets"
      min_lines: 10
    - path: "backend/app/seed/fixtures/bullets.json"
      provides: "100-200 bullet records from 5 major manufacturers"
      min_lines: 1000
    - path: "backend/app/seed/fixtures/cartridges.json"
      provides: "50+ cartridge records with SAAMI/CIP specs"
      min_lines: 500
  key_links:
    - from: "backend/app/seed/fixtures/powders.json"
      to: "backend/app/models/powder.py"
      via: "JSON keys match Powder model column names"
      pattern: "force_constant_j_kg|burn_rate_coeff|alias_group"
    - from: "backend/app/seed/fixtures/bullets.json"
      to: "backend/app/models/bullet.py"
      via: "JSON keys match Bullet model column names including new fields"
      pattern: "model_number|bullet_type|base_type"
    - from: "backend/app/seed/fixtures/cartridges.json"
      to: "backend/app/models/cartridge.py"
      via: "JSON keys match Cartridge model column names including new fields"
      pattern: "parent_cartridge_name|shoulder_diameter_mm"
---

<objective>
Compile comprehensive fixture datasets as JSON files for pre-loading on Docker boot: 200+ powders from multiple manufacturers with burn model parameters, 100-200 bullets from Sierra/Hornady/Berger/Nosler/Lapua covering major precision calibers, 50+ cartridges from SAAMI/CIP specs, and powder alias mappings.

Purpose: These fixtures are the core data deliverable of Phase 5. Without them, the simulator ships with only ~10 powders, ~10 bullets, and ~5 cartridges -- insufficient for real-world use. Users expect to simulate immediately without manual data entry.
Output: 4 JSON fixture files under `backend/app/seed/fixtures/`.
</objective>

<execution_context>
@C:/Users/vall-/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/vall-/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/05-import-pipelines-and-fixture-data/05-RESEARCH.md
@.planning/phases/05-import-pipelines-and-fixture-data/05-CONTEXT.md

Reference for field names and data types:
@backend/app/models/powder.py
@backend/app/models/bullet.py
@backend/app/models/cartridge.py
@docs/materials_database.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Compile powder fixture data (200+ powders) and alias mappings</name>
  <files>
    backend/app/seed/fixtures/powders.json
    backend/app/seed/fixtures/powder_aliases.json
  </files>
  <action>
Create directory `backend/app/seed/fixtures/` if it does not exist.

**powders.json** -- Compile a JSON array of 200+ powder records. Each record has these fields (matching Powder model columns):
- `name` (string, unique): Full commercial name (e.g., "Hodgdon Varget")
- `manufacturer` (string): Manufacturer name (e.g., "Hodgdon/ADI", "Vihtavuori", "Alliant")
- `burn_rate_relative` (float): Relative burn rate position (0-200 scale, lower=faster)
- `force_constant_j_kg` (float): Force constant, typically 800000-1200000 J/kg. Use manufacturer data where available, otherwise use generic SB (~950000) or DB (~1050000) defaults from `docs/materials_database.md`
- `covolume_m3_kg` (float): Typically ~0.001 m3/kg for all NC-based propellants
- `flame_temp_k` (float): Adiabatic flame temperature. Use manufacturer data where available; SB default ~3500-4000K, DB default ~3200-3700K
- `gamma` (float): Ratio of specific heats, typically 1.22-1.26 for NC
- `density_g_cm3` (float): Solid grain density (NOT bulk). ~1.60 for SB, ~1.62-1.65 for DB
- `burn_rate_coeff` (float): Vieille 'a' coefficient. Estimate from burn rate relative position: faster=higher, slower=lower. Range ~5e-9 to ~3e-8
- `burn_rate_exp` (float): Vieille 'n' exponent, typically 0.80-0.92
- `data_source` (string): "grt_community" for GRT-sourced, "manufacturer" for manufacturer data, "estimated" for generic defaults
- `web_thickness_mm` (float|null): Grain web thickness in mm, null when unknown
- `ba`, `bp`, `br`, `brp`, `z1`, `z2` (float|null): 3-curve GRT parameters, null for most powders (only populate where GRT data is available)
- `alias_group` (string|null): Alias group identifier (e.g., "varget-ar2208") or null if no known alias

**Powder coverage by manufacturer** (compile from published burn rate charts, manufacturer catalogs, and `docs/materials_database.md`):
1. **Hodgdon** (~30 powders): H110, H322, H335, BL-C(2), H4895, Benchmark, Varget, H4350, H4831SC, H1000, Retumbo, H50BMG, Trail Boss, CFE223, CFE BLK, Superformance, plus additional varieties
2. **ADI** (~20 powders): AR2205, AR2206H, AR2207, AR2208, AR2209, AR2213SC, AR2217, AR2218, AR2219, BM2, BM8208, AR2206, Trail Boss, and others. Each ADI powder with a Hodgdon equivalent gets its OWN record with the same alias_group
3. **IMR** (~20 powders): IMR 3031, 4064, 4166, 4198, 4227, 4320, 4350, 4451, 4895, 4955, 7828, 8133, plus Enduron series
4. **Vihtavuori** (~20 powders): N110 through N570 (N110, N120, N130, N133, N135, N140, N150, N160, N165, N170, N540, N550, N555, N560, N565, N568, N570, plus 24N41)
5. **Alliant** (~15 powders): Reloder 7, 10x, 15, 16, 17, 19, 22, 23, 25, 26, 33, Power Pro 2000-MR, AR-Comp
6. **Accurate/Western** (~10 powders): 2200, 2230, 2460, 2495, 2520, 4064, 4350, Magpro, LT-30, LT-32
7. **Norma** (~10 powders): 200, 201, 202, 203B, 204, 217, URP, MRP
8. **Ramshot** (~8 powders): TAC, X-Terminator, Big Game, Hunter, Magnum, LRT
9. **Winchester** (~8 powders): 231, 296, 748, 760, 780, StaBALL 6.5, StaBALL HD
10. **Other** (~10 powders): Shooters World, Lovex, Vectan varieties for coverage

For thermochemical constants, follow this priority:
1. Published manufacturer data (force_constant, flame_temp)
2. Values from `docs/materials_database.md` for powders listed there
3. Generic single-base or double-base defaults based on powder type
4. Set `data_source` accordingly: "manufacturer" for (1), "grt_community" for (2), "estimated" for (3)

The existing 10 seed powders (IMR 4198, H322, N133, H335, N135, IMR 4064, Varget, N140, H4350, Retumbo) MUST be included in the fixture with their exact field values preserved (to maintain backward compatibility with the existing seed). Update their `data_source` to "manual" to preserve their provenance.

**powder_aliases.json** -- A JSON object where keys are alias group identifiers and values are arrays of powder names that belong to that group:
```json
{
  "varget-ar2208": ["Hodgdon Varget", "ADI AR2208"],
  "h4350-ar2209": ["Hodgdon H4350", "ADI AR2209"],
  "h4895-ar2206h": ["Hodgdon H4895", "ADI AR2206H"],
  "h1000-ar2217": ["Hodgdon H1000", "ADI AR2217"],
  "retumbo-ar2225": ["Hodgdon Retumbo", "ADI AR2225"],
  "h4198-ar2207": ["Hodgdon H4198", "ADI AR2207"],
  "h322-ar2219": ["Hodgdon H322", "ADI AR2219"],
  "h4831-ar2213sc": ["Hodgdon H4831SC", "ADI AR2213SC"],
  "h50bmg-ar2218": ["Hodgdon H50BMG", "ADI AR2218"],
  "benchmark-bm2": ["Hodgdon Benchmark", "ADI BM2"],
  "trailboss": ["Hodgdon Trail Boss", "ADI Trail Boss"]
}
```

Every powder name in powder_aliases.json MUST exist in powders.json. Verify this constraint during compilation.
  </action>
  <verify>
1. `python -c "import json; data=json.load(open('backend/app/seed/fixtures/powders.json')); print(f'{len(data)} powders'); assert len(data) >= 200, 'Need 200+ powders'"` -- confirm 200+ records
2. `python -c "import json; data=json.load(open('backend/app/seed/fixtures/powders.json')); names=set(d['name'] for d in data); assert len(names)==len(data), f'Duplicate names: {len(data)-len(names)}'"` -- confirm no duplicate names
3. `python -c "import json; data=json.load(open('backend/app/seed/fixtures/powders.json')); aliases=json.load(open('backend/app/seed/fixtures/powder_aliases.json')); all_names=set(d['name'] for d in data); missing=[n for names in aliases.values() for n in names if n not in all_names]; assert not missing, f'Missing: {missing}'"` -- verify alias names exist
4. Verify all required fields are present: `python -c "import json; data=json.load(open('backend/app/seed/fixtures/powders.json')); req=['name','manufacturer','burn_rate_relative','force_constant_j_kg','covolume_m3_kg','flame_temp_k','gamma','density_g_cm3','burn_rate_coeff','burn_rate_exp','data_source']; [print(f'Missing {f} in {d[\"name\"]}') for d in data for f in req if f not in d or d[f] is None]"` -- no missing required fields
5. Confirm original 10 seed powders are present with exact values
  </verify>
  <done>
powders.json has 200+ unique powder records from 10+ manufacturers with all required thermochemical fields populated. powder_aliases.json links 11+ ADI/Hodgdon equivalences. All alias names reference existing powder records. Original 10 seed powders preserved with exact values.
  </done>
</task>

<task type="auto">
  <name>Task 2: Compile bullet and cartridge fixture data</name>
  <files>
    backend/app/seed/fixtures/bullets.json
    backend/app/seed/fixtures/cartridges.json
  </files>
  <action>
**bullets.json** -- Compile a JSON array of 100-200 bullet records. Each record has these fields (matching Bullet model columns):
- `name` (string, unique): Full name with weight and type (e.g., "Sierra 168gr HPBT MatchKing #2200")
- `manufacturer` (string): "Sierra", "Hornady", "Berger", "Nosler", or "Lapua"
- `model_number` (string|null): Manufacturer part/catalog number (e.g., "2200", "26331")
- `weight_grains` (float): Bullet weight in grains
- `diameter_mm` (float): Bullet diameter in mm (5.56mm for .224, 6.17mm for .243, 6.50mm for .264, 7.04mm for .284, 7.82mm for .308, 8.61mm for .338, etc.)
- `length_mm` (float|null): Overall bullet length in mm (null when unknown)
- `bc_g1` (float): Ballistic coefficient G1 model (always available from manufacturer)
- `bc_g7` (float|null): Ballistic coefficient G7 model (null when not published)
- `sectional_density` (float): Compute as weight_grains / (7000 * diameter_inches^2) where diameter_inches = diameter_mm / 25.4
- `material` (string): "copper" for jacketed, "copper_solid" for monolithic
- `bullet_type` (string): "match" for target/precision, "hunting" for hunting bullets
- `base_type` (string): "hollow_point_boat_tail", "polymer_tip_boat_tail", "flat_base", "hollow_point_flat_base", "polymer_tip_flat_base", "open_tip_match_boat_tail"
- `data_source` (string): "manufacturer" for all catalog-sourced data

**Bullet coverage by manufacturer (match/precision AND hunting lines per user decision, NO varmint/plinking/FMJ):**

1. **Sierra** (~30-35 bullets):
   - MatchKing: .224 (52, 69, 77gr), .264 (107, 123, 130, 140, 142gr), .284 (168, 175, 180gr), .308 (155, 168, 175, 190, 200, 210, 220gr), .338 (250, 300gr)
   - GameKing: .264 (120, 140gr), .308 (150, 165, 180gr), .338 (215gr)

2. **Hornady** (~30-35 bullets):
   - ELD Match: .224 (52, 73, 75, 80gr), .243 (108gr), .264 (120, 130, 140, 147gr), .284 (162, 180gr), .308 (155, 168, 178, 208gr), .338 (285gr)
   - ELD-X: .243 (90gr), .264 (120, 127, 143gr), .284 (150, 162, 175gr), .308 (178, 200, 212gr), .338 (230, 270gr)

3. **Berger** (~25-30 bullets):
   - Target/Hybrid Target: .224 (70, 73, 80.5gr), .264 (130, 140, 144gr), .308 (155.5, 168, 175, 185, 200.20gr), .338 (250, 300gr)
   - VLD Hunting: .264 (120, 130, 140gr), .308 (168, 175, 185, 210gr)

4. **Nosler** (~15-20 bullets):
   - AccuBond: .264 (130, 140gr), .284 (140, 150, 160gr), .308 (165, 180, 200gr)
   - Partition: .264 (125, 140gr), .308 (150, 165, 180, 200gr)

5. **Lapua** (~10-15 bullets):
   - Scenar/Scenar-L: .224 (69, 77gr), .264 (123, 136, 139, 144gr), .308 (155, 167, 170, 185gr), .338 (250, 300gr)

**Caliber coverage must include:** .224 (5.56mm), .243 (6.17mm), .264 (6.5mm), .284 (7mm), .308 (7.82mm), .338 (8.61mm). Also include .270 (6.83mm) and .30-06 caliber bullets (.308 diameter) as they share .308 diameter bullets.

The existing 10 seed bullets MUST be included in the fixture. Preserve their exact field values and add the new fields (model_number, bullet_type, base_type) to them.

For BC values: Use manufacturer published G1 BCs. Include G7 where the manufacturer publishes it (Sierra and Berger typically do; Hornady publishes G7 for ELD series; Nosler and Lapua varies). Set bc_g7 to null when not available.

For sectional_density: Always compute from weight and diameter. SD = weight_grains / (7000 * (diameter_mm / 25.4)^2).

**cartridges.json** -- Compile a JSON array of 50+ cartridge records. Each record has these fields:
- `name` (string, unique): Standard cartridge name (e.g., ".308 Winchester")
- `saami_max_pressure_psi` (float): SAAMI MAP in PSI
- `cip_max_pressure_mpa` (float|null): CIP max pressure in MPa (null if not CIP standardized)
- `case_capacity_grains_h2o` (float): Case water capacity in grains
- `case_length_mm` (float): Case length in mm
- `overall_length_mm` (float): Cartridge overall length in mm
- `bore_diameter_mm` (float): Bore diameter in mm
- `groove_diameter_mm` (float): Groove diameter in mm
- `parent_cartridge_name` (string|null): Parent cartridge name (null if original/military)
- `shoulder_diameter_mm` (float|null): Shoulder diameter in mm
- `neck_diameter_mm` (float|null): Neck diameter in mm
- `base_diameter_mm` (float|null): Base (body) diameter in mm
- `rim_diameter_mm` (float|null): Rim diameter in mm
- `data_source` (string): "saami" for SAAMI-sourced, "cip" for CIP-sourced, "manufacturer" for proprietary

**Cartridge coverage (all from user decision + popular proprietary per Claude's discretion):**

Core SAAMI/CIP standardized cartridges:
.223 Remington, .22-250 Remington, .220 Swift, .243 Winchester, 6mm Creedmoor, 6mm BR Norma, .25-06 Remington, .257 Roberts, 6.5 Creedmoor, 6.5x47 Lapua, 6.5x55 Swedish, .260 Remington, .264 Winchester Magnum, .270 Winchester, .270 WSM, 7mm-08 Remington, 7mm Remington Magnum, 7mm WSM, .280 Remington, .280 Ackley Improved, .284 Winchester, .30-30 Winchester, .300 Savage, .308 Winchester, .30-06 Springfield, .300 Winchester Magnum, .300 WSM, .300 Norma Magnum, .300 Ruger Compact Magnum, .300 Remington Ultra Magnum, .338 Lapua Magnum, .338 Federal, .338 Winchester Magnum

Popular proprietary/newer cartridges (per user decision, include based on data availability):
6.5 PRC, .224 Valkyrie, .300 PRC, 6mm ARC, .22 Nosler, .26 Nosler, .27 Nosler, .28 Nosler, .30 Nosler, .33 Nosler, .300 Blackout, .375 Ruger, .375 H&H Magnum, .416 Rigby, .458 Winchester Magnum, .338 Norma Magnum, 6.5-284 Norma, .204 Ruger, 7mm PRC

The existing 5 seed cartridges (.223 Remington, 6.5 Creedmoor, .308 Winchester, .30-06 Springfield, .338 Lapua Magnum) MUST be included with their exact current field values preserved. Add the new fields (parent_cartridge_name, extended dims) to them.

For parent cartridge lineage: well-established relationships include:
- .308 Win parent: .300 Savage
- 6.5 Creedmoor parent: .30 TC
- .30-06 parent: null (military original)
- .223 Rem parent: .222 Remington
- .300 WM parent: .375 H&H Magnum (necked down)
- etc.
  </action>
  <verify>
1. `python -c "import json; data=json.load(open('backend/app/seed/fixtures/bullets.json')); print(f'{len(data)} bullets'); assert len(data) >= 100, 'Need 100+ bullets'"` -- confirm 100+ records
2. `python -c "import json; data=json.load(open('backend/app/seed/fixtures/bullets.json')); names=set(d['name'] for d in data); assert len(names)==len(data), f'Duplicate bullet names'"` -- no duplicate names
3. `python -c "import json; data=json.load(open('backend/app/seed/fixtures/bullets.json')); mfgs=set(d['manufacturer'] for d in data); print(f'Manufacturers: {sorted(mfgs)}'); assert len(mfgs) >= 5"` -- confirm 5+ manufacturers
4. `python -c "import json; data=json.load(open('backend/app/seed/fixtures/cartridges.json')); print(f'{len(data)} cartridges'); assert len(data) >= 50, 'Need 50+ cartridges'"` -- confirm 50+ records
5. `python -c "import json; data=json.load(open('backend/app/seed/fixtures/cartridges.json')); names=set(d['name'] for d in data); assert len(names)==len(data), f'Duplicate cartridge names'"` -- no duplicates
6. Verify original seed bullets and cartridges are present with exact values
7. Verify no varmint/plinking/FMJ bullets in the fixture (check bullet_type field)
  </verify>
  <done>
bullets.json has 100-200 unique bullet records from Sierra, Hornady, Berger, Nosler, and Lapua covering .224, .243, .264, .284, .308, and .338 calibers with match and hunting types only. cartridges.json has 50+ unique cartridge records with SAAMI/CIP specs, extended dimensions, and parent cartridge lineage. Original seed data preserved.
  </done>
</task>

</tasks>

<verification>
1. All 4 fixture files are valid JSON and parse without errors
2. powders.json >= 200 records, bullets.json >= 100 records, cartridges.json >= 50 records
3. No duplicate names within any fixture file
4. All powder alias names in powder_aliases.json exist in powders.json
5. All bullet records have the required fields (name, manufacturer, weight_grains, diameter_mm, bc_g1, sectional_density, material, bullet_type, base_type, data_source)
6. All cartridge records have the required fields (name, saami_max_pressure_psi, case_capacity_grains_h2o, case_length_mm, overall_length_mm, bore_diameter_mm, groove_diameter_mm, data_source)
7. Original seed data (10 powders, 10 bullets, 5 cartridges) preserved with exact values
</verification>

<success_criteria>
- 4 JSON fixture files exist under backend/app/seed/fixtures/
- Powder fixture has 200+ records from 10+ manufacturers with all required thermochemical fields
- Bullet fixture has 100-200 records from 5 manufacturers covering 6+ calibers, match and hunting types only
- Cartridge fixture has 50+ records with SAAMI/CIP specs, extended dimensions, parent lineage
- Alias fixture maps 10+ known ADI/Hodgdon equivalences
- All JSON is valid and parseable
- No duplicate names in any fixture file
</success_criteria>

<output>
After completion, create `.planning/phases/05-import-pipelines-and-fixture-data/05-02-SUMMARY.md`
</output>
