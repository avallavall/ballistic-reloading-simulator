---
milestone: v1.2
audited: 2026-02-22T00:00:00Z
status: gaps_found
scores:
  requirements: 9/21
  phases: 2/4
  integration: 11/14
  flows: 3/5
gaps:
  requirements:
    - id: "PWD-01"
      status: "unsatisfied"
      phase: "Phase 5"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "missing"
      evidence: "Phase 5 not started — no phase directory, no plans, no verification"
    - id: "PWD-05"
      status: "unsatisfied"
      phase: "Phase 5"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "missing"
      evidence: "Phase 5 not started"
    - id: "BUL-01"
      status: "unsatisfied"
      phase: "Phase 5"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "missing"
      evidence: "Phase 5 not started"
    - id: "BUL-02"
      status: "unsatisfied"
      phase: "Phase 5"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "missing"
      evidence: "Phase 5 not started"
    - id: "BUL-03"
      status: "unsatisfied"
      phase: "Phase 5"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "missing"
      evidence: "Phase 5 not started"
    - id: "BUL-04"
      status: "unsatisfied"
      phase: "Phase 5"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "missing"
      evidence: "Phase 5 not started"
    - id: "CRT-01"
      status: "unsatisfied"
      phase: "Phase 5"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "missing"
      evidence: "Phase 5 not started"
    - id: "CRT-02"
      status: "unsatisfied"
      phase: "Phase 5"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "missing"
      evidence: "Phase 5 not started"
    - id: "CRT-03"
      status: "unsatisfied"
      phase: "Phase 5"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "missing"
      evidence: "Phase 5 not started"
    - id: "QLT-01"
      status: "unsatisfied"
      phase: "Phase 6"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "missing"
      evidence: "Phase 6 not started — quality badges exist for powders (Phase 3) but not bullets/cartridges in frontend"
    - id: "SRC-04"
      status: "unsatisfied"
      phase: "Phase 6"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "missing"
      evidence: "Phase 6 not started — searchable picker modals not implemented"
    - id: "SRC-05"
      status: "unsatisfied"
      phase: "Phase 6"
      claimed_by_plans: []
      completed_by_plans: []
      verification_status: "missing"
      evidence: "Phase 6 not started — frontend pagination UI not implemented"
  integration:
    - from: "backend/app/db/migrations/versions/006_search_and_pagination.py"
      to: "backend/app/api/cartridges.py"
      issue: "Migration backfills cartridge caliber_family using bore_diameter_mm but runtime code uses groove_diameter_mm. .308 Win seeded cartridges get NULL caliber_family."
      severity: "medium"
      affected_requirements: ["SRC-03"]
    - from: "backend/app/seed/initial_data.py"
      to: "backend/app/core/quality.py"
      issue: "Seed data does not compute quality_score for bullets or cartridges. All seeded bullets/cartridges have quality_score=0."
      severity: "low-medium"
      affected_requirements: ["SRC-03"]
    - from: "frontend/src/lib/api.ts"
      to: "backend/app/api/powders.py"
      issue: "Frontend API client never passes search/filter/page params. Pagination/search infrastructure unreachable from UI."
      severity: "low"
      affected_requirements: ["SRC-01", "SRC-02", "SRC-03"]
      note: "Planned gap — Phase 6 will add the frontend search/filter UI"
  flows:
    - flow: "User browses bullets filtered by caliber family"
      breaks_at: "Step 5: frontend has no filter UI to pass caliber_family param"
      severity: "low"
      note: "Phase 6 will address"
    - flow: "Seeded cartridge caliber_family backfill"
      breaks_at: "Step 2: migration uses wrong diameter field for backfill"
      severity: "medium"
tech_debt:
  - phase: 03-schema-and-quality-system
    items:
      - "PowderUpdate TypeScript interface defined but unused (dead code). useUpdatePowder uses Partial<PowderCreate>."
      - "Backend PowderUpdate schema accepts data_source field without restriction. Client-side deletion prevents corruption, but API-level guard missing."
  - phase: 04-search-and-pagination
    items:
      - "Migration 006 cartridge backfill uses bore_diameter_mm instead of groove_diameter_mm — needs corrective migration 007"
      - "Seed data does not compute quality_score for bullets/cartridges — need to mirror powder pattern"
      - "Dynamic sub-routes (/manufacturers, /caliber-families) have zero frontend consumers until Phase 6"
      - "Fuzzy search (pg_trgm) untested at runtime — SQLite test suite skips it"
---

# v1.2 Milestone Audit: Component Databases + Search

**Audited:** 2026-02-22
**Status:** GAPS FOUND
**Score:** 9/21 requirements satisfied

## Milestone Scope

- **Milestone:** v1.2 — Component Databases + Search
- **Goal:** Build comprehensive pre-loaded component databases with quality indicators, multi-source import pipelines, and advanced search/filtering so users can simulate immediately without manual data entry.
- **Phases:** 4 total (Phase 3, 4, 5, 6)
- **Completed:** 2 of 4 (Phase 3 and Phase 4)

## Phase Status

| Phase | Name | Status | Verification | Requirements |
|-------|------|--------|--------------|--------------|
| 3 | Schema and Quality System | ✓ Complete | PASSED (5/5 truths) | 6/6 satisfied |
| 4 | Search and Pagination | ✓ Complete | PASSED (12/12 truths) | 3/3 satisfied |
| 5 | Import Pipelines and Fixture Data | ✗ Not started | No directory | 0/9 — unsatisfied |
| 6 | Frontend Integration | ✗ Not started | No directory | 0/3 — unsatisfied |

## Requirements Coverage (3-Source Cross-Reference)

### Phase 3 Requirements (6/6 Satisfied)

| REQ-ID | Description | VERIFICATION.md | REQUIREMENTS.md | Final |
|--------|-------------|-----------------|-----------------|-------|
| PWD-02 | Quality badges on powders | SATISFIED | `[x]` Complete | **satisfied** |
| PWD-03 | Quality score 0-100 with tooltip | SATISFIED | `[x]` Complete | **satisfied** |
| PWD-04 | Data source provenance tracking | SATISFIED | `[x]` Complete | **satisfied** |
| QLT-02 | Auto-recompute quality on PUT | SATISFIED | `[x]` Complete | **satisfied** |
| QLT-03 | Deterministic quality formula | SATISFIED | `[x]` Complete | **satisfied** |
| SOL-01 | Solver reads per-powder web_thickness | SATISFIED | `[x]` Complete | **satisfied** |

### Phase 4 Requirements (3/3 Satisfied)

| REQ-ID | Description | VERIFICATION.md | REQUIREMENTS.md | Final |
|--------|-------------|-----------------|-----------------|-------|
| SRC-01 | Server-side pagination on all endpoints | SATISFIED | `[x]` Complete | **satisfied** |
| SRC-02 | Fuzzy search with pg_trgm | SATISFIED | `[x]` Complete | **satisfied** |
| SRC-03 | Multi-field filtering | SATISFIED | `[x]` Complete | **satisfied** |

### Phase 5 Requirements (0/9 — Unsatisfied)

| REQ-ID | Description | Status | Reason |
|--------|-------------|--------|--------|
| PWD-01 | Batch import 200+ GRT powders | unsatisfied | Phase not started |
| PWD-05 | Powder aliases (cross-market) | unsatisfied | Phase not started |
| BUL-01 | 100-200 pre-loaded bullets | unsatisfied | Phase not started |
| BUL-02 | Extended bullet record fields | unsatisfied | Phase not started |
| BUL-03 | Nullable bullet fields with completeness | unsatisfied | Phase not started |
| BUL-04 | Batch import bullets from JSON | unsatisfied | Phase not started |
| CRT-01 | 50+ pre-loaded cartridges | unsatisfied | Phase not started |
| CRT-02 | Cartridge lineage and dimensions | unsatisfied | Phase not started |
| CRT-03 | Batch import cartridges from JSON | unsatisfied | Phase not started |

### Phase 6 Requirements (0/3 — Unsatisfied)

| REQ-ID | Description | Status | Reason |
|--------|-------------|--------|--------|
| QLT-01 | Quality badges on ALL components | unsatisfied | Phase not started |
| SRC-04 | Searchable picker modals | unsatisfied | Phase not started |
| SRC-05 | Frontend pagination UI | unsatisfied | Phase not started |

### Orphaned Requirements

None. All 21 requirements in REQUIREMENTS.md are mapped to phases and accounted for.

## Cross-Phase Integration

**Score:** 11/14 exports wired correctly

### Verified Wiring (Phase 3 <-> Phase 4)

- Phase 3 `quality.py` scorer extended for bullets/cartridges in Phase 4 (`compute_bullet_quality_score`, `compute_cartridge_quality_score`)
- Phase 3 migration 005 -> Phase 4 migration 006 chain intact (`down_revision` correct)
- Phase 4 `paginate()` + `apply_fuzzy_search()` wired in all 3 list endpoints
- Phase 4 `PaginatedResponse` -> frontend `api.ts` -> hooks `select: data.items` backward compat verified
- Phase 3 quality computed fields flow through Phase 4 paginated responses
- Phase 3 solver `web_thickness_mm` integration unaffected by Phase 4 changes

### Issues Found

| # | From | To | Issue | Severity | Affected REQs |
|---|------|-----|-------|----------|---------------|
| 1 | Migration 006 | api/cartridges.py | Cartridge caliber_family backfill uses `bore_diameter_mm` but runtime uses `groove_diameter_mm`. .308 Win gets NULL. | Medium | SRC-03 |
| 2 | seed/initial_data.py | core/quality.py | Seed skips quality_score computation for bullets/cartridges. All seeded records = 0. | Low-Medium | SRC-03 |
| 3 | frontend/api.ts | backend endpoints | Frontend never passes search/filter/page params. Phase 6 will address. | Low (planned) | SRC-01, SRC-02, SRC-03 |

## E2E Flows

**Score:** 3/5 complete

| Flow | Status | Details |
|------|--------|---------|
| Powder quality badge E2E (create -> badge -> edit -> recompute) | ✓ Complete | All integration points wired |
| Simulation with per-powder web_thickness | ✓ Complete | DB read -> solver fallback working |
| Bullet/cartridge quality on API create | ✓ Complete | Quality auto-compute + caliber family derive on create/update |
| User browses bullets filtered by caliber | ✗ Broken | No frontend filter UI (Phase 6 planned) |
| Seeded cartridge caliber_family accuracy | ✗ Broken | Migration backfill uses wrong diameter field |

## Tech Debt

### Phase 3: Schema and Quality System
1. `PowderUpdate` TypeScript interface defined but unused (dead code)
2. Backend `PowderUpdate` schema accepts `data_source` field without API-level guard

### Phase 4: Search and Pagination
1. Migration 006 cartridge backfill uses `bore_diameter_mm` instead of `groove_diameter_mm` — needs corrective migration
2. Seed data does not compute `quality_score` for bullets/cartridges
3. Dynamic sub-routes (`/manufacturers`, `/caliber-families`) have zero frontend consumers until Phase 6
4. Fuzzy search (pg_trgm) untested at runtime — SQLite test suite skips it

**Total:** 6 items across 2 phases (non-blocking)

---

_Audited: 2026-02-22_
_Auditor: Claude (gsd-audit-milestone)_
