---
phase: 07-cross-phase-integration-fixes
task: 0
total_tasks: 0
status: not_started
last_updated: 2026-02-23T09:20:10.124Z
---

<current_state>
Phase 7 was just created by `/gsd:plan-milestone-gaps` to close 3 integration bugs and 3 broken E2E flows found by the v1.2 milestone audit. The phase directory exists but has NO plans yet. User chose to run `/gsd:discuss-phase 7` before planning but hasn't done so yet.
</current_state>

<completed_work>

- Milestone audit (`/gsd:audit-milestone`) completed: found 3 orphaned requirements (Phase 6), 3 integration bugs, 3 broken flows
- Gap closure planning (`/gsd:plan-milestone-gaps`) completed: created Phase 7 in ROADMAP.md
- Phase 7 directory created: `.planning/phases/07-cross-phase-integration-fixes/`
- ROADMAP.md updated: Phase 7 added with success criteria, execution order changed to 3->4->5->7->6
- REQUIREMENTS.md timestamp updated
- Committed: `docs(roadmap): add gap closure phase 7 for integration fixes`
</completed_work>

<remaining_work>

- Run `/gsd:discuss-phase 7` to capture design preferences (user requested this)
- Run `/gsd:plan-phase 7` to create PLAN.md files
- Run `/gsd:execute-phase 7` to implement the 4 fixes
- Then proceed to Phase 6 (Frontend Integration) which depends on Phase 7
</remaining_work>

<decisions_made>

- Grouped all 3 integration bugs + tech debt into a single Phase 7 (rather than expanding Phase 6)
- Phase 7 executes BEFORE Phase 6 since frontend UI work depends on correct API wiring
- Phase 6 already existed in roadmap for the 3 orphaned requirements (QLT-01, SRC-04, SRC-05) -- no changes needed there
- Integration fixes protect already-satisfied requirements (PWD-01, SRC-02, BUL-03) -- no checkbox resets in REQUIREMENTS.md
</decisions_made>

<blockers>
None
</blockers>

<context>
Phase 7 has 4 targeted fixes:
1. **pg_trgm bootstrap** (Critical): `create_all` in app startup doesn't create pg_trgm extension or GIN indexes. Fuzzy search crashes on fresh Docker boot without `alembic upgrade head`. Fix: add extension+index creation to lifespan startup.
2. **GRT import mode param** (Critical): Frontend `api.ts` sends `?overwrite=true` but backend expects `?mode=overwrite` (ImportMode enum). Overwrite silently ignored. Fix: change frontend param name.
3. **TypeScript nullable** (High): `Bullet.length_mm` and `bc_g7` typed as required `number` in `types.ts` but backend returns `null`. Fix: make them `number | null`.
4. **GrtImportResult interface** (Tech debt): Missing `updated[]` and `mode` fields added in Phase 5. Fix: add fields to TS interface.

All fixes are small, targeted changes. Single plan should suffice.
</context>

<next_action>
Start with: `/gsd:discuss-phase 7` to capture any user preferences about the fixes, then `/gsd:plan-phase 7` to create the plan.
</next_action>
